<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenWrtç¼–è¯‘æ•™å­¦ | ä¸œæ¾ˆçš„æŠ˜è…¾å¤©åœ°</title>


  <!-- æ’ä»¶ / åŠŸèƒ½èµ„æº -->
   <!-- æ’ä»¶ / åŠŸèƒ½èµ„æº -->

  <!-- å¼•å…¥ CSS æ ·å¼ -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/assets/css/header.css">
  <link rel="stylesheet" href="/assets/css/footer.css">
  <link rel="stylesheet" href="/assets/css/post.css">
  <link rel="stylesheet" href="/assets/css/friends.css">
  <link rel="stylesheet" href="/assets/css/blog.css">
  <link rel="stylesheet" href="/assets/css/index.css">
  <link rel="stylesheet" href="/assets/css/music-player.css">

  <!-- Aplayeræ’­æ”¾å™¨ -->
  <link rel="stylesheet" href="https://cdn.tungchiahui.cn/libs/aplayer/1.10.1/APlayer.min.css">
  <script defer src="https://cdn.tungchiahui.cn/libs/aplayer/1.10.1/APlayer.min.js"></script>
  <!-- MetingéŸ³ä¹èµ„æºåŠ è½½å™¨ -->
  <script defer src="https://cdn.tungchiahui.cn/libs/meting/1.2.0/Meting.min.js"></script>

  <!-- ä»£ç é«˜äº®æ ·å¼ -->
  <link rel="stylesheet" href="/assets/css/code-highlight.css">
  <script defer src="/assets/js/code-copy.js"></script>

  <!-- Font Awesome -->
  <link href="https://cdn.tungchiahui.cn/libs/font-awesome/7.1.0/fontawesome.min.css" rel="stylesheet">
  <script defer src="https://cdn.tungchiahui.cn/libs/font-awesome/7.1.0/all.min.js"></script>

  <!-- === å›¾ç‰‡ç‚¹å‡»æ”¾å¤§åŠŸèƒ½(å»¶è¿ŸåŠ è½½) === -->
  <script defer src="https://cdn.tungchiahui.cn/libs/medium-zoom/1.1.0/medium-zoom.min.js"></script>
  <script defer src="/assets/js/image-zoom.js"></script>

  <!-- æ‡’åŠ è½½ -->
  <script defer src="/assets/js/lazyload.js"></script>

  <!-- æ‹¼éŸ³è½¬æ¢åº“åŠè„šæœ¬(ä»ç„¶æœ‰é—®é¢˜) -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/pinyin-pro@3.27.0/dist/index.min.js"></script>
  <script defer src="/assets/js/pinyin.js"></script> -->

  <!-- Vercount ç½‘ç«™è®¿é—®ç»Ÿè®¡ -->
  <script async src="https://events.vercount.one/js"></script>

  <script defer src="https://umami.tungchiahui.cn/script.js" data-website-id="0d79b40f-ff86-484b-80c1-fb6a5b6dbbe9"></script>

  <!-- æ”¾åœ¨æ¨¡æ¿åº•éƒ¨ï¼Œlazyload.js æˆ–å…¶ä»–ä¸»è„šæœ¬ä¹‹å -->
  <script defer src="/assets/js/pjax-vercount.js"></script>


  <!-- ç½‘ç«™å›¾æ ‡ -->
  
  <link rel="icon" 
        href="https://cdn.tungchiahui.cn/tungwebsite/assets/images/favicon.webp">


</head>

  <body>
    <header class="site-header">

  <!-- å†…å®¹å±‚ -->
  <div class="header-content">
    <h1><a href="/">ä¸œæ¾ˆçš„æŠ˜è…¾å¤©åœ°</a></h1>
    <nav>
      <ul>
        <li><a href="/">é¦–é¡µ</a></li>
        <li><a href="/blog/">åšå®¢</a></li>
        <li><a href="/wiki/">Wiki</a></li>
        <li><a href="/cv/">ç®€å†</a></li>
        <li><a href="/friends/">å‹é“¾</a></li>
        <li><a href="/about/">å…³äº</a></li>
      </ul>
    </nav>
  </div>
</header>
    
    <!-- ğŸµ éŸ³ä¹æ’­æ”¾å™¨ -->
<div id="music-player" class="aplayer player"
     data-id="9619599108"
     data-server="tencent"
     data-type="playlist"
     data-autoplay="false">
</div>


<!-- ğŸ§ æŒ‰é’® -->
<button id="toggle-player-fixed" aria-pressed="false">ğŸ§ æ”¶èµ·</button>


<script>
(() => {
  const container = document.getElementById('music-player');
  const btnFixed = document.getElementById('toggle-player-fixed');
  let hidden = false;

  try {
    const saved = localStorage.getItem('music_player_hidden');
    if (saved === 'true') {
      hidden = true;
      container.classList.add('hidden');
      btnFixed.textContent = 'ğŸ§ å±•å¼€';
      btnFixed.classList.remove('open');
    } else {
      btnFixed.textContent = 'ğŸ§ æ”¶èµ·';
      btnFixed.classList.add('open');
    }
  } catch(e){}

  btnFixed.addEventListener('click', () => {
    hidden = !hidden;
    if (hidden) {
      container.classList.add('hidden');
      btnFixed.textContent = 'ğŸ§ å±•å¼€';
      btnFixed.classList.remove('open');
    } else {
      container.classList.remove('hidden');
      btnFixed.textContent = 'ğŸ§ æ”¶èµ·';
      btnFixed.classList.add('open');
    }
    try { 
      localStorage.setItem('music_player_hidden', hidden ? 'true' : 'false'); 
    } catch(e){}
  });
})();
</script>


    <!-- PJAX -->
    <main id="pjax-container">
      <article class="post-main">
  <h2>OpenWrtç¼–è¯‘æ•™å­¦</h2>
  <p>
    <small>
      å‘å¸ƒäº 2021-09-16 | ä½œè€…: Tung Chia-hui | é˜…è¯»æ¬¡æ•°ï¼š<span id="vercount_value_page_pv">Loading</span> æ¬¡
    </small>
  </p>
  <div class="post-content">
    <ul id="markdown-toc">
  <li><a href="#ç¼–è¯‘ç¯å¢ƒå‡†å¤‡" id="markdown-toc-ç¼–è¯‘ç¯å¢ƒå‡†å¤‡">ç¼–è¯‘ç¯å¢ƒå‡†å¤‡</a>    <ul>
      <li><a href="#ç¯å¢ƒè¯´æ˜" id="markdown-toc-ç¯å¢ƒè¯´æ˜">ç¯å¢ƒè¯´æ˜</a></li>
      <li><a href="#åŸºç¡€ç¼–è¯‘è¿‡ç¨‹" id="markdown-toc-åŸºç¡€ç¼–è¯‘è¿‡ç¨‹">åŸºç¡€ç¼–è¯‘è¿‡ç¨‹</a></li>
    </ul>
  </li>
  <li><a href="#è¿˜æœ‰ä¸ª" id="markdown-toc-è¿˜æœ‰ä¸ª">è¿˜æœ‰ä¸ª</a>    <ul>
      <li><a href="#é‡æ–°é…ç½®" id="markdown-toc-é‡æ–°é…ç½®">é‡æ–°é…ç½®</a></li>
      <li><a href="#ç¼–è¯‘æ›´æ¢å…¶å®ƒcpuæ¶æ„çš„å›ºä»¶å»ºè®®æ“ä½œ" id="markdown-toc-ç¼–è¯‘æ›´æ¢å…¶å®ƒcpuæ¶æ„çš„å›ºä»¶å»ºè®®æ“ä½œ">ç¼–è¯‘æ›´æ¢å…¶å®ƒCPUæ¶æ„çš„å›ºä»¶ï¼ˆå»ºè®®æ“ä½œï¼‰</a></li>
    </ul>
  </li>
  <li><a href="#ä¸ªæ€§åŒ–é…ç½®" id="markdown-toc-ä¸ªæ€§åŒ–é…ç½®">ä¸ªæ€§åŒ–é…ç½®</a>    <ul>
      <li><a href="#ä¿®æ”¹é»˜è®¤ä¸»é¢˜" id="markdown-toc-ä¿®æ”¹é»˜è®¤ä¸»é¢˜">ä¿®æ”¹é»˜è®¤ä¸»é¢˜</a>        <ul>
          <li><a href="#ä¸ªæ€§åŒ–ä¸»é¢˜" id="markdown-toc-ä¸ªæ€§åŒ–ä¸»é¢˜">ä¸ªæ€§åŒ–ä¸»é¢˜</a></li>
          <li><a href="#ä¸ªæ€§åŒ–ä¸»æœºå" id="markdown-toc-ä¸ªæ€§åŒ–ä¸»æœºå">ä¸ªæ€§åŒ–ä¸»æœºå</a></li>
          <li><a href="#è‡ªå®šä¹‰é»˜è®¤å¯†ç " id="markdown-toc-è‡ªå®šä¹‰é»˜è®¤å¯†ç ">è‡ªå®šä¹‰é»˜è®¤å¯†ç </a></li>
          <li><a href="#ç»ˆç«¯æ¨ªå¹…" id="markdown-toc-ç»ˆç«¯æ¨ªå¹…">ç»ˆç«¯æ¨ªå¹…</a></li>
          <li><a href="#æ— çº¿æ›´æ”¹" id="markdown-toc-æ— çº¿æ›´æ”¹">æ— çº¿æ›´æ”¹</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#æ’ä»¶å¼€å‘" id="markdown-toc-æ’ä»¶å¼€å‘">æ’ä»¶å¼€å‘</a>    <ul>
      <li><a href="#æ’ä»¶æºç çš„æ–‡ä»¶ç»„æˆ" id="markdown-toc-æ’ä»¶æºç çš„æ–‡ä»¶ç»„æˆ">æ’ä»¶æºç çš„æ–‡ä»¶ç»„æˆ</a>        <ul>
          <li><a href="#åˆ›å»ºæ„å»ºæ–‡ä»¶makefile" id="markdown-toc-åˆ›å»ºæ„å»ºæ–‡ä»¶makefile">åˆ›å»ºæ„å»ºæ–‡ä»¶Makefile</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#è¡¥å……å·¥å…·" id="markdown-toc-è¡¥å……å·¥å…·">è¡¥å……å·¥å…·</a>    <ul>
      <li><a href="#ä¿®æ”¹æ¥å£macåœ°å€" id="markdown-toc-ä¿®æ”¹æ¥å£macåœ°å€">ä¿®æ”¹æ¥å£MACåœ°å€</a></li>
    </ul>
  </li>
  <li><a href="#å…¶ä»–å‚è€ƒèµ„æ–™" id="markdown-toc-å…¶ä»–å‚è€ƒèµ„æ–™">å…¶ä»–å‚è€ƒèµ„æ–™</a></li>
</ul>

<h1 id="ç¼–è¯‘ç¯å¢ƒå‡†å¤‡">ç¼–è¯‘ç¯å¢ƒå‡†å¤‡</h1>

<h2 id="ç¯å¢ƒè¯´æ˜">ç¯å¢ƒè¯´æ˜</h2>
<p>æœ¬æ•™ç¨‹ä»¥ä¹Œç­å›¾22.04ä½œä¸ºç¯å¢ƒ
è¯·ç¡®ä¿ç¼–è¯‘è¿‡ç¨‹å…¨å±€é­”æ³•</p>

<h2 id="åŸºç¡€ç¼–è¯‘è¿‡ç¨‹">åŸºç¡€ç¼–è¯‘è¿‡ç¨‹</h2>

<p>è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ï¼‰ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>æ³¨æ„ä½¿ç”¨rootç¼–è¯‘ä¼šæŠ¥é”™ï¼Œå¯ä»¥åœ¨/etc/profile æœ€åæ·»åŠ export <span class="nv">FORCE_UNSAFE_CONFIGURE</span><span class="o">=</span>1,ç„¶åæ‰§è¡Œ
<span class="nb">export </span><span class="nv">FORCE_UNSAFE_CONFIGURE</span><span class="o">=</span>1
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>ç³»ç»Ÿè½¯ä»¶åŒ…æ›´æ–°
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nt">-y</span> update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get <span class="nt">-y</span> upgrade
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>å®‰è£…ä¾èµ–å…³ç³»ä¸ç¼–è¯‘å·¥å…·é“¾
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> ack antlr3 aria2 asciidoc autoconf automake autopoint binutils bison build-essential <span class="se">\</span>
bzip2 ccache cmake cpio curl device-tree-compiler fastjar flex gawk gettext gcc-multilib g++-multilib <span class="se">\</span>
git gperf haveged help2man intltool libc6-dev-i386 libelf-dev libglib2.0-dev libgmp3-dev libltdl-dev <span class="se">\</span>
libmpc-dev libmpfr-dev libncurses5-dev libncursesw5-dev libreadline-dev libssl-dev libtool lrzsz <span class="se">\</span>
mkisofs msmtp nano ninja-build p7zip p7zip-full patch pkgconf python2.7 python3 python3-pip libpython3-dev qemu-utils <span class="se">\</span>
rsync scons squashfs-tools subversion swig texinfo uglifyjs upx-ucl unzip vim wget xmlto xxd zlib1g-dev
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>ä¸‹è½½ OpenWrt æºç 
```bash
git clone https://github.com/openwrt/openwrt.git &amp;&amp; cd openwrt 
git clone https://github.com/coolsnowwolf/lede &amp;&amp; cd lede</li>
</ol>

<h1 id="è¿˜æœ‰ä¸ª">è¿˜æœ‰ä¸ª</h1>
<p>git clone https://github.com/istoreos/istoreos</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>
ï¼ˆæºç æœ‰å¾ˆå¤šï¼Œæœ¬æ•™ç¨‹ä»¥å®˜æ–¹æºç å’ŒLEDEä¸ºä¾‹ï¼‰ 

4. åˆ‡æ¢é€‚åˆåˆ†æ”¯ 

openwrt-22.03 å·²å°† iptables ç§»é™¤ï¼Œä¸ºé¿å…å…¼å®¹æ€§é—®é¢˜ï¼Œæš‚æ—¶åˆ‡æ¢åˆ° openwrt-21.02åˆ†æ”¯: 
```bash
git checkout openwrt-21.02
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>æ›´æ–°å¹¶å®‰è£… feeds è½¯ä»¶æº
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>./scripts/feeds update <span class="nt">-a</span> <span class="o">&amp;&amp;</span> ./scripts/feeds <span class="nb">install</span> <span class="nt">-a</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>ï¼ˆä»¥ä¸‹ä¸ºæ ¡å›­ç½‘é˜²æ£€æµ‹éƒ¨ç½²ï¼‰</p>

<ol>
  <li>åŠ å…¥æ¨¡å—
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>git clone https://github.com/Zxilly/UA2F.git package/UA2F
git clone https://github.com/CHN-beta/rkp-ipid.git package/rkp-ipid 
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>é…ç½®ç¼–è¾‘
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make menuconfig
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>é…ç½®ç¼–è¯‘ rdp-ipid:</p>
<ul>
  <li>Kernel modules â†’ Other modules â†’ kmod-rkp-ipid</li>
</ul>

<p>é…ç½®ç¼–è¯‘ ua2f:</p>
<ul>
  <li>Network â†’ Routing and Redirection â†’ UA2F</li>
</ul>

<p>é…ç½®ç¼–è¯‘ iptables æ¨¡å—ï¼ˆFirewallä¸­ï¼‰</p>

<p>é€‰ä¸­ï¼š</p>
<ul>
  <li>iptables-mod-filter</li>
  <li>iptables-mod-ipopt</li>
  <li>iptables-mod-u32</li>
</ul>

<p>åŸºæœ¬ç•Œé¢é…ç½®ï¼š</p>
<ul>
  <li>LuCI â†’ Collections â†’ luci ï¼ˆlede é»˜è®¤å·²é€‰ï¼‰</li>
  <li>LuCI â†’ Modules â†’ Translations â†’ Chinese Simplified (zh_Hans) ï¼ˆlede é»˜è®¤å·²é€‰ï¼‰</li>
  <li>LuCI â†’ Modules â†’ luci-compat</li>
  <li>LuCI â†’ Applications â†’ luci-app-ttydï¼ˆç½‘é¡µç»ˆç«¯ï¼‰</li>
  <li>LuCI â†’ Themes â†’ xxxxx (æ ¹æ®éœ€è¦è‡ªå·±é€‰ç®¡ç†ç•Œé¢çš„ä¸»é¢˜ï¼Œå¦‚æœè·¯ç”±å™¨å‚¨å­˜å¤ªå°ï¼Œå»ºè®®å°±ç»´æŒé»˜è®¤çš„)</li>
</ul>

<p>å…¶ä»–é…ç½®ï¼š</p>
<ul>
  <li>æ·»åŠ EXT4ç¡¬ç›˜æ ¼å¼æ”¯æŒï¼šKernel modules &gt; Filesystem &gt; kmod-fs-ext4</li>
  <li>æ·»åŠ USBæ”¯æŒï¼ˆå¦‚ä¸æ·»åŠ å¯èƒ½ä¼šä¸å“åº”é”®ç›˜ï¼‰ï¼šKernel modules &gt; USB Support</li>
</ul>

<p>ç½‘å¡é©±åŠ¨é…ç½®ï¼š</p>
<ul>
  <li>ç»æŸ¥æ‰¾ç½‘å¡ä½¿ç”¨çš„æ˜¯Intel IG211-ATï¼Œèµ°çš„æ˜¯PCIEé€šé“ï¼Œè¿™é‡Œè¦é€‰ç”¨e1000e</li>
  <li>Kernel modules &gt; Network Deviceså°†kmod-e1000eï¼Œkmod-igbé©±åŠ¨é€‰ä¸­</li>
</ul>

<p>æ— çº¿ç½‘å¡é©±åŠ¨ï¼š</p>
<ul>
  <li>å†…æ ¸ä¸­çš„æ— çº¿é©±åŠ¨æ‰¾åˆ°RTL8821AEçš„é©±åŠ¨</li>
  <li>Kernel modules &gt; Wireless Drivers</li>
</ul>

<blockquote>
  <p>ä½œè€…ï¼šKANSUNG
é“¾æ¥ï¼šhttps://www.jianshu.com/p/5190ab903820
æ¥æºï¼šç®€ä¹¦</p>
</blockquote>

<p>æ·»åŠ å…¶ä»–å·¥å…·ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<ul>
  <li>LuCI &gt; Applications -&gt; luci-app-openclash</li>
  <li>LuCI &gt; Applications -&gt; luci-app-adblock</li>
  <li>LuCI &gt; Applications -&gt; luci-app-ddns-go</li>
</ul>

<p>æ·»åŠ å¿…è¦ç»„ä»¶ï¼š</p>
<ul>
  <li>Kernel modules -&gt; Network Support -&gt; kmod-tun ï¼ˆopenclash TUNæ¨¡å¼å¿…é¡»ï¼‰</li>
</ul>

<p>æ’é™¤å†²çªç»„ä»¶ï¼š</p>
<ul>
  <li>Base system -&gt; dnsmasq (å–æ¶ˆå‹¾é€‰ï¼Œå› ä¸ºé»˜è®¤ä¼šå®‰è£…dnsmasq-fullï¼Œéœ€è¦æ’é™¤dnsmasqé¿å…å†²çªæŠ¥é”™ï¼‰</li>
</ul>

<p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</p>
<ul>
  <li>ä½¿ç”¨ vim .configï¼Œåœ¨å¼€å¤´æ·»åŠ ä¸€è¡Œï¼ˆUA2F æ’ä»¶éœ€è¦ï¼‰ï¼š
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">CONFIG_NETFILTER_NETLINK_GLUE_CT</span><span class="o">=</span>y
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<ol>
  <li>ç¼–è¯‘å’Œé…ç½®å†…æ ¸
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>make kernel_menuconfig
make <span class="nt">-j1</span> <span class="nv">V</span><span class="o">=</span>sc kernel_menuconfig  <span class="c"># æ—¥å¿—æ›´è¯¦ç»†</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>é…ç½®è·¯å¾„ï¼š
Networking support â†’
  Networking options â†’
    Network packet filtering framework (Netfilter) ï¼ˆè¦å…ˆé€‰ä¸­å†è¿›å»ï¼‰â†’
      Core Netfilter Configuration â†’</p>

<p>é€‰ä¸­ä»¥ä¸‹é€‰é¡¹ï¼š</p>
<ul>
  <li>Netfilter NFNETLINK interface</li>
  <li>Netfilter LOG over NFNETLINK interface</li>
  <li>Netfilter connection tracking support</li>
  <li>Connection tracking netlink interface</li>
  <li>NFQUEUE and NFLOG integration with Connection Tracking</li>
</ul>

<ol>
  <li>ç¼–è¯‘
ä¸‹è½½ç¼–è¯‘å·¥å…·ï¼š
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make download <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="nv">V</span><span class="o">=</span>s
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<p>å¼€å§‹ç¼–è¯‘ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>make <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="nv">V</span><span class="o">=</span>s
make <span class="nt">-j1</span> <span class="nv">V</span><span class="o">=</span>sc 2&gt; build.log  <span class="c"># é”™è¯¯è¾“å‡ºåˆ°æ—¥å¿—</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>äºŒæ¬¡ç¼–è¯‘éœ€è¦æ›´æ–°æºç ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git pull
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="é‡æ–°é…ç½®">é‡æ–°é…ç½®</h3>
<p>å¦‚æœéœ€è¦é‡æ–°é…ç½®ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">rm</span> <span class="nt">-rf</span> ./tmp <span class="o">&amp;&amp;</span> <span class="nb">rm</span> <span class="nt">-rf</span> .config
make menuconfig
make <span class="nt">-j</span><span class="k">$((</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="o">+</span> <span class="m">1</span><span class="k">))</span> <span class="nv">V</span><span class="o">=</span>s   <span class="c"># å¤šçº¿ç¨‹ç¼–è¯‘å¤±è´¥åè‡ªåŠ¨è¿›å…¥å•çº¿ç¨‹ç¼–è¯‘ï¼Œå¤±è´¥åˆ™è¾“å‡ºè¯¦ç»†æ—¥å¿—</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="ç¼–è¯‘æ›´æ¢å…¶å®ƒcpuæ¶æ„çš„å›ºä»¶å»ºè®®æ“ä½œ">ç¼–è¯‘æ›´æ¢å…¶å®ƒCPUæ¶æ„çš„å›ºä»¶ï¼ˆå»ºè®®æ“ä½œï¼‰</h3>

<p>æ¸…é™¤æ—§çš„ç¼–è¯‘äº§ç‰©ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make clean
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>åœ¨æºç æœ‰å¤§è§„æ¨¡æ›´æ–°æˆ–è€…å†…æ ¸æ›´æ–°åæ‰§è¡Œï¼Œä»¥ä¿è¯ç¼–è¯‘è´¨é‡ã€‚æ­¤æ“ä½œä¼šåˆ é™¤/binå’Œ/build_dirç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p>
</blockquote>

<p>æ¸…é™¤æ—§çš„ç¼–è¯‘äº§ç‰©ã€äº¤å‰ç¼–è¯‘å·¥å…·åŠå·¥å…·é“¾ç­‰ç›®å½•ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make dirclean
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>æ›´æ¢æ¶æ„ç¼–è¯‘å‰å¿…é¡»æ‰§è¡Œã€‚æ­¤æ“ä½œä¼šåˆ é™¤/binå’Œ/build_dirç›®å½•çš„ä¸­çš„æ–‡ä»¶(make clean)ä»¥åŠ/staging_dirã€/toolchainã€/tmpå’Œ/logsä¸­çš„æ–‡ä»¶ã€‚</p>
</blockquote>

<p>æ¸…é™¤ OpenWrt æºç ä»¥å¤–çš„æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make distclean
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>é™¤éæ˜¯åšå¼€å‘ï¼Œå¹¶æ‰“ç®— push åˆ° GitHub è¿™æ ·çš„è¿œç¨‹ä»“åº“ï¼Œå¦åˆ™å‡ ä¹ç”¨ä¸åˆ°ã€‚æ­¤æ“ä½œç›¸å½“äºmake dircleanå¤–åŠ åˆ é™¤/dlã€/feedsç›®å½•å’Œ.configæ–‡ä»¶ã€‚</p>
</blockquote>

<p>è¿˜åŸ OpenWrt æºç åˆ°åˆå§‹çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git clean <span class="nt">-xdf</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>å¦‚æœæŠŠæºç æ”¹åäº†ï¼Œæˆ–è€…é•¿æ—¶é—´æ²¡æœ‰è¿›è¡Œç¼–è¯‘æ—¶ä½¿ç”¨ã€‚</p>
</blockquote>

<p>æ¸…é™¤ä¸´æ—¶æ–‡ä»¶ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm</span> <span class="nt">-rf</span> tmp
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>åˆ é™¤æ‰§è¡Œmake menuconfigåäº§ç”Ÿçš„ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è½¯ä»¶åŒ…çš„æ£€ç´¢ä¿¡æ¯ï¼Œåˆ é™¤åä¼šé‡æ–°åŠ è½½packageç›®å½•ä¸‹çš„è½¯ä»¶åŒ…ã€‚è‹¥ä¸åˆ é™¤ä¼šå¯¼è‡´ä¸€äº›æ–°åŠ å…¥çš„è½¯ä»¶åŒ…ä¸æ˜¾ç¤ºã€‚</p>
</blockquote>

<p>åˆ é™¤ç¼–è¯‘é…ç½®æ–‡ä»¶ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm</span> <span class="nt">-f</span> .config
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>åœ¨ä¸åˆ é™¤çš„æƒ…å†µä¸‹å¦‚æœå–æ¶ˆé€‰æ‹©æŸäº›ç»„ä»¶å®ƒçš„ä¾èµ–ç»„ä»¶ä¸ä¼šè‡ªåŠ¨å–æ¶ˆï¼Œæ‰€ä»¥å¯¹äºéœ€è¦è°ƒæ•´ç»„ä»¶çš„æƒ…å†µä¸‹å»ºè®®åˆ é™¤ã€‚</p>
</blockquote>

<p>æ³¨æ„ï¼šæ‰€æœ‰æ“ä½œä¸è¦ä½¿ç”¨rootç”¨æˆ·</p>

<blockquote>
  <p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚</p>

  <p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u010674953/article/details/129280724</p>
</blockquote>

<h1 id="ä¸ªæ€§åŒ–é…ç½®">ä¸ªæ€§åŒ–é…ç½®</h1>

<h2 id="ä¿®æ”¹é»˜è®¤ä¸»é¢˜">ä¿®æ”¹é»˜è®¤ä¸»é¢˜</h2>
<p>è¿›å…¥è·¯å¾„<code class="language-plaintext highlighter-rouge">openwrt/feeds/luci/collections/luci</code>ï¼Œä¿®æ”¹<code class="language-plaintext highlighter-rouge">Makefile</code>ï¼ˆé€‚ç”¨äºopenwrtç‰ˆæœ¬19.07ï¼Œä¸åŒçš„ç‰ˆæœ¬ï¼Œä¼šç¨å¾®ä¸åŒï¼‰ï¼š</p>
<ul>
  <li>å°†LUCI_DESCRIPTIONä¸­ï¼Œbootstrap æ›¿æ¢ä¸º argon</li>
  <li>å°†LUCI_DEPENDSä¸­ï¼Œ+luci-theme-bootstrap æ›¿æ¢ä¸º +luci-theme-argon</li>
</ul>

<p>åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/pyt1234567890/article/details/107442792</p>

<h4 id="ä¸ªæ€§åŒ–ä¸»é¢˜">ä¸ªæ€§åŒ–ä¸»é¢˜</h4>
<p>ä»¥ â€œargonâ€ä¸»é¢˜ä¸ºä¾‹ï¼Œå¯ç¼–è¾‘æ€§å¼ºè¦æ›´æ”¹OpenWrtæºç ä¸­çš„ä¸»é¢˜ï¼ŒåŒ…æ‹¬Argonä¸»é¢˜ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>

<ol>
  <li>è¿›å…¥<code class="language-plaintext highlighter-rouge">feeds/luci/themes/</code>ç›®å½•</li>
  <li>æ‰¾åˆ°Argonä¸»é¢˜æ‰€åœ¨çš„ç›®å½•ï¼ˆä¸€èˆ¬ä¸º<code class="language-plaintext highlighter-rouge">luci-theme-argon</code>ï¼‰ï¼Œå¹¶è¿›å…¥è¯¥ç›®å½•</li>
  <li>æ‰“å¼€<code class="language-plaintext highlighter-rouge">root/usr/share/luci/static/resources/view/themes/argon/header.htm</code>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº†Argonä¸»é¢˜çš„é¡¶éƒ¨å¯¼èˆªæ ã€LOGOç­‰å†…å®¹</li>
  <li>åœ¨header.htmæ–‡ä»¶ä¸­æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„å†…å®¹ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„ç¼–è¾‘å’Œä¿å­˜ã€‚ä¾‹å¦‚ï¼Œå°†LOGOå›¾ç‰‡è·¯å¾„æŒ‡å‘è‡ªå·±çš„å›¾ç‰‡æ–‡ä»¶ï¼Œæˆ–è€…è°ƒæ•´å¯¼èˆªæ çš„å¸ƒå±€å’Œæ ·å¼</li>
  <li>å¦‚æœéœ€è¦ä¿®æ”¹Argonä¸»é¢˜çš„å…¶ä»–éƒ¨åˆ†ï¼Œä¾‹å¦‚åº•éƒ¨å¯¼èˆªæ ã€é¢œè‰²æ–¹æ¡ˆç­‰ï¼Œå¯ä»¥åœ¨<code class="language-plaintext highlighter-rouge">root/usr/share/luci/static/resources/view/themes/argon/</code>ç›®å½•ä¸‹æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶è¿›è¡Œç¼–è¾‘</li>
</ol>

<h4 id="ä¸ªæ€§åŒ–ä¸»æœºå">ä¸ªæ€§åŒ–ä¸»æœºå</h4>
<p>ä¿®æ”¹<code class="language-plaintext highlighter-rouge">package/base-files/files/bin/config_generate</code>ï¼Œå°†<code class="language-plaintext highlighter-rouge">"OpenWrt"</code>æ›¿æ¢</p>

<h4 id="è‡ªå®šä¹‰é»˜è®¤å¯†ç ">è‡ªå®šä¹‰é»˜è®¤å¯†ç </h4>
<p>ä¿®æ”¹passwdæ–‡ä»¶</p>

<h4 id="ç»ˆç«¯æ¨ªå¹…">ç»ˆç«¯æ¨ªå¹…</h4>
<p>ä¿®æ”¹æ–‡ä»¶ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>./package/base-files/files/etc/banner
</pre></td></tr></tbody></table></code></pre></div></div>
<p>æ¨ªå¹…ç”Ÿæˆåœ°å€ï¼šhttp://www.network-science.de/ascii/</p>

<h4 id="æ— çº¿æ›´æ”¹">æ— çº¿æ›´æ”¹</h4>
<p>ä¿®æ”¹æ–‡ä»¶ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/package/kernel/mac80211/files/lib/wifi/mac80211.sh    <span class="c"># (ssid)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¿®æ”¹è‡ªå®šä¹‰ç‰ˆæœ¬å·ï¼šopenwrt_release</p>

<h1 id="æ’ä»¶å¼€å‘">æ’ä»¶å¼€å‘</h1>

<h2 id="æ’ä»¶æºç çš„æ–‡ä»¶ç»„æˆ">æ’ä»¶æºç çš„æ–‡ä»¶ç»„æˆ</h2>
<p>Openwrtæ’ä»¶ä¸€èˆ¬ä½¿ç”¨â€MVCâ€ç»“æ„ï¼š</p>

<ol>
  <li>é…ç½®æ–‡ä»¶
ä½äº <code class="language-plaintext highlighter-rouge">/etc/config/*</code>ï¼š
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>config server
option username ''
option password ''
</pre></td></tr></tbody></table></code></pre></div>    </div>
    <p>ä¾‹ç¤ºæ–‡ä»¶ä¸­ç”Ÿæˆäº†ä¸¤ä¸ªå¾…è¾“å…¥çš„é…ç½®ã€‚ç°åœ¨éœ€è¦ä¸€ä¸ªè¡¨å•é¡µé¢æ¥ç®¡ç†å®ƒã€‚</p>
  </li>
  <li>CBIæ–‡ä»¶
ä¸€èˆ¬ä½äºç›®å½• <code class="language-plaintext highlighter-rouge">/usr/lib/lua/luci/model/cbi/*.lua</code>ï¼š</li>
</ol>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="nb">require</span><span class="p">(</span><span class="s2">"luci.sys"</span><span class="p">)</span>

<span class="c1">-- é¡µé¢æ ‡é¢˜å’Œæè¿°</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="s2">"bargo"</span><span class="p">,</span> <span class="n">translate</span><span class="p">(</span><span class="s2">"Bargo Client"</span><span class="p">),</span> <span class="n">translate</span><span class="p">(</span><span class="s2">"Configure Bargo client, Powered By Sinchie."</span><span class="p">))</span>

<span class="c1">-- è¯»å–é…ç½®æ–‡ä»¶</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">m</span><span class="p">:</span><span class="n">section</span><span class="p">(</span><span class="n">TypedSection</span><span class="p">,</span> <span class="s2">"server"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">addremove</span> <span class="o">=</span> <span class="kc">false</span>
<span class="n">s</span><span class="p">.</span><span class="n">anonymous</span> <span class="o">=</span> <span class="kc">true</span>

<span class="c1">-- æ˜¯å¦å¯ç”¨çš„é€‰æ‹©æ¡†</span>
<span class="n">enable</span> <span class="o">=</span> <span class="n">s</span><span class="p">:</span><span class="n">option</span><span class="p">(</span><span class="n">Flag</span><span class="p">,</span> <span class="s2">"enable"</span><span class="p">,</span> <span class="n">translate</span><span class="p">(</span><span class="s2">"Enable"</span><span class="p">))</span>
<span class="c1">-- æ˜ å°„æˆ‘ä»¬çš„é…ç½®åˆ°è¾“å…¥æ¡†</span>
<span class="n">username</span> <span class="o">=</span> <span class="n">s</span><span class="p">:</span><span class="n">option</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="s2">"username"</span><span class="p">,</span> <span class="n">translate</span><span class="p">(</span><span class="s2">"Username"</span><span class="p">))</span>
<span class="n">pass</span> <span class="o">=</span> <span class="n">s</span><span class="p">:</span><span class="n">option</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="s2">"password"</span><span class="p">,</span> <span class="n">translate</span><span class="p">(</span><span class="s2">"Password"</span><span class="p">))</span>
<span class="n">pass</span><span class="p">.</span><span class="n">password</span> <span class="o">=</span> <span class="kc">true</span>

<span class="c1">-- å¦‚æœç‚¹å‡»äº†ä¿å­˜æŒ‰é’®</span>
<span class="kd">local</span> <span class="n">apply</span> <span class="o">=</span> <span class="n">luci</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">formvalue</span><span class="p">(</span><span class="s2">"cbi.apply"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">apply</span> <span class="k">then</span>
    <span class="c1">-- è¿™é‡Œæ˜¯è°ƒç”¨æˆ‘ä»¬è‡ªå·±çš„ç¨‹åºè„šæœ¬ï¼Œåé¢ä¼šè®²æ€ä¹ˆæ¥å†™è¿™ä¸ªè„šæœ¬</span>
    <span class="nb">io.popen</span><span class="p">(</span><span class="s2">"/etc/init.d/bargo restart &gt; /dev/null &amp;"</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">return</span> <span class="n">m</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li>æ§åˆ¶å™¨æ–‡ä»¶
ä¸€èˆ¬ä½äºç³»ç»Ÿçš„<code class="language-plaintext highlighter-rouge">/usr/lib/lua/luci/controller/*.lua</code>ï¼Œåˆ›å»ºæ§åˆ¶å™¨æ–‡ä»¶åå¯ä»¥åœ¨webç•Œé¢åˆ›å»ºä¸€ä¸ªç•Œé¢å…¥å£ï¼ˆèœå•ï¼‰ã€‚è„šæœ¬ç»“æ„å¦‚ä¸‹ï¼š</li>
</ol>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1">-- module åç§°</span>
<span class="n">module</span><span class="p">(</span><span class="s2">"luci.controller.bargo"</span><span class="p">,</span> <span class="n">package</span><span class="p">.</span><span class="n">seeall</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
    <span class="c1">-- 4 ä¸ªå‚æ•°ä»‹ç»</span>
    <span class="c1">-- 1.åå°è®¿é—®è·¯å¾„ admin/services/bargo </span>
    <span class="c1">-- 2.target åŠ¨ä½œï¼ˆcall, template, cbiï¼‰call æ˜¯è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°ï¼Œtemplate è°ƒç”¨ html æ¨¡æ¿ï¼Œcbi è°ƒç”¨ openwrt çš„å…¬å…±è¡¨å•é¡µé¢</span>
    <span class="c1">-- 3.èœå•åç§° </span>
    <span class="c1">-- 4.æ’åº</span>
    <span class="n">entry</span><span class="p">({</span><span class="s2">"admin"</span><span class="p">,</span> <span class="s2">"services"</span><span class="p">,</span> <span class="s2">"bargo"</span><span class="p">},</span> <span class="n">cbi</span><span class="p">(</span><span class="s2">"bargo"</span><span class="p">),</span> <span class="n">_</span><span class="p">(</span><span class="s2">"Bargo Client"</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="åˆ›å»ºæ„å»ºæ–‡ä»¶makefile">åˆ›å»ºæ„å»ºæ–‡ä»¶Makefile</h4>

<p>åˆ¶ä½œ OpenWRT ç¼–è¯‘ Makefile æ–‡ä»¶éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š</p>

<ol>
  <li>å®‰è£… OpenWRT SDKï¼Œå¹¶è®¾ç½®ç¯å¢ƒå˜é‡</li>
  <li>åœ¨ä»»æ„ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾ä½ çš„åº”ç”¨ç¨‹åºä»£ç </li>
  <li>åœ¨è¯¥ç›®å½•ä¸‹ï¼Œåˆ›å»º <code class="language-plaintext highlighter-rouge">Makefile</code> æ–‡ä»¶ï¼Œå¹¶æŒ‰ç…§ä»¥ä¸‹ç»“æ„å¡«å†™ç›¸åº”å†…å®¹ï¼š</li>
</ol>

<div class="language-makefile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>
<span class="c"># è¿™æ˜¯æ³¨é‡Šï¼Œå¯ä»¥å¿½ç•¥æˆ–è€…ä¿®æ”¹
</span>
<span class="k">include</span><span class="sx"> $(TOPDIR)/rules.mk</span> <span class="c"># å¼•å…¥OpenWRTç¼–è¯‘è§„åˆ™
</span><span class="nv">PKG_NAME</span><span class="o">:=</span>myapp <span class="c"># åº”ç”¨ç¨‹åºçš„åç§°ï¼Œå»ºè®®ä½¿ç”¨å°å†™å­—æ¯å’Œæ•°å­—ç»„åˆ</span>
<span class="nv">PKG_VERSION</span><span class="o">:=</span>1.0 <span class="c"># åº”ç”¨ç¨‹åºçš„ç‰ˆæœ¬å·</span>
<span class="nv">PKG_RELEASE</span><span class="o">:=</span>1 <span class="c"># åº”ç”¨ç¨‹åºçš„å‘è¡Œç‰ˆæœ¬å·</span>

<span class="k">include</span><span class="sx"> $(INCLUDE_DIR)/package.mk</span> <span class="c"># å¼•å…¥OpenWRTä¸­æä¾›çš„è½¯ä»¶åŒ…æ¨¡æ¿
</span><span class="k">define</span> <span class="nv">Package/myapp </span><span class="c"># æè¿°åº”ç”¨ç¨‹åºçš„ä¿¡æ¯
</span>  <span class="nv">SECTION</span><span class="o">:=</span>net
  <span class="nv">CATEGORY</span><span class="o">:=</span>Network
  <span class="nv">TITLE</span><span class="o">:=</span>My Application
  <span class="nv">DEPENDS</span><span class="o">:=</span>+libopenssl +libcurl +libjson-c 
<span class="k">endef</span>

<span class="k">define</span> <span class="nv">Package/myapp/description </span><span class="c"># æè¿°åº”ç”¨ç¨‹åºåŠŸèƒ½å’Œç”¨é€”
</span> <span class="err">My</span> <span class="err">Application</span> <span class="err">is</span> <span class="err">a</span> <span class="err">simple</span> <span class="err">program</span> <span class="err">that</span> <span class="err">does</span> <span class="err">something</span> <span class="err">useful.</span>
<span class="k">endef</span>

<span class="k">define</span> <span class="nv">Build/Prepare </span><span class="c"># å‡†å¤‡æ„å»ºåº”ç”¨ç¨‹åºæ‰€éœ€çš„æºç å’Œèµ„æº
</span>
<span class="c"># æ­¤å¤„å¯ä»¥æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ï¼Œç”¨äºå‡†å¤‡åº”ç”¨ç¨‹åºçš„æºç å’Œèµ„æº
</span><span class="k">endef</span>

<span class="k">define</span> <span class="nv">Build/Configure </span><span class="c"># é…ç½®åº”ç”¨ç¨‹åºçš„ç¼–è¯‘é€‰é¡¹
</span>
<span class="c"># æ­¤å¤„å¯ä»¥æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ï¼Œç”¨äºé…ç½®åº”ç”¨ç¨‹åºçš„ç¼–è¯‘é€‰é¡¹
</span><span class="k">endef</span>

<span class="k">define</span> <span class="nv">Build/Compile </span><span class="c"># ç¼–è¯‘åº”ç”¨ç¨‹åºçš„æºç 
</span>
<span class="c"># æ­¤å¤„å¯ä»¥æ·»åŠ è‡ªå®šä¹‰å‘½ä»¤ï¼Œç”¨äºç¼–è¯‘åº”ç”¨ç¨‹åºçš„æºç 
</span><span class="k">endef</span>

<span class="k">define</span> <span class="nv">Package/myapp/install </span><span class="c"># å®‰è£…åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ–‡ä»¶å’Œç›®å½•
</span><span class="err">$(INSTALL_DIR)</span> <span class="err">$(1)/usr/bin</span> <span class="c"># åˆ›å»ºå®‰è£…ç›®å½•
</span><span class="err">$(INSTALL_BIN)</span> <span class="err">$(PKG_BUILD_DIR)/myapp</span> <span class="err">$(1)/usr/bin/</span> <span class="c"># å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶
</span><span class="k">endef</span>

<span class="nf">$(</span><span class="nb">eval</span> <span class="p">$(</span>call BuildPackage,myapp<span class="p">))</span> <span class="c"># æ„å»ºè½¯ä»¶åŒ…å¹¶æ³¨å†Œåˆ°OpenWRTä¸­
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="è¡¥å……å·¥å…·">è¡¥å……å·¥å…·</h1>

<h2 id="ä¿®æ”¹æ¥å£macåœ°å€">ä¿®æ”¹æ¥å£MACåœ°å€</h2>
<p>ä¿®æ”¹MACåœ°å€ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>uci <span class="nb">set </span>network.cfg050f15.macaddr<span class="o">=</span><span class="s1">'98:8F:E0:67:44:86'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä¿å­˜æ›´æ”¹ï¼š</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>uci commit network
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="å…¶ä»–å‚è€ƒèµ„æ–™">å…¶ä»–å‚è€ƒèµ„æ–™</h1>
<p>æ·»åŠ USBå’Œç¡¬ç›˜æ ¼å¼è¿˜æœ‰ç½‘å¡æ•™ç¨‹ï¼š
https://www.jianshu.com/p/5190ab903820</p>

  </div>
</article>

    </main>

    <footer>
  <p>Â© 2026 ä¸œæ¾ˆçš„æŠ˜è…¾å¤©åœ°. All rights reserved.</p>

  <!-- ç¤¾äº¤å›¾æ ‡ -->
  <div class="footer-social">
    
      <a href="https://jekyll.tungchiahui.cn" target="_blank" rel="noopener" title="Website">
        <i class="fas fa-link"></i>
      </a>
    
    
      <a href="mailto:tungchiahui@gmail.com" target="_blank" rel="noopener" title="E-Mail">
        <i class="fas fa-envelope"></i>
      </a>
    
    
      <a href="https://github.com/tungchiahui" target="_blank" rel="noopener" title="GitHub">
        <i class="fab fa-github"></i>
      </a>
    
    
      <a href="https://qm.qq.com/q/JRhksaNK82?from=qq" target="_blank" rel="noopener" title="QQ">
        <i class="fab fa-qq"></i>
      </a>
    
    
      <a href="https://t.me/tungchiahui" target="_blank" rel="noopener" title="Telegram">
        <i class="fab fa-telegram"></i>
      </a>
    
    
      <a href="http://www.coolapk.com/u/3224578" target="_blank" rel="noopener" title="CoolAPK">
        <i class="fab fa-android"></i>
      </a>
    
    
      <a href="https://space.bilibili.com/141482453" target="_blank" rel="noopener" title="Bilibili">
        <i class="fa-brands fa-bilibili"></i>
      </a>
    
    
      <a href="https://www.youtube.com/@Chia-huiTung" target="_blank" rel="noopener" title="YouTube">
        <i class="fab fa-youtube"></i>
      </a>
    
    
      <a href="https://twitter.com/tungchiahui" target="_blank" rel="noopener" title="Twitter">
        <i class="fab fa-twitter"></i>
      </a>
    
    
      <a href="https://www.facebook.com/tungchiahui" target="_blank" rel="noopener" title="Facebook">
        <i class="fab fa-facebook"></i>
      </a>
    
    
      <a href="https://www.instagram.com/tungchiahui" target="_blank" rel="noopener" title="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
    
  </div>

  <!-- IPv6 / SSL è®¤è¯å¾½ç«  -->
<div class="footer-cert">
  <a href="https://ipw.cn/ipv6webcheck/?site=https://jekyll.tungchiahui.cn" 
     title="æœ¬ç«™æ”¯æŒIPv6è®¿é—®" target="_blank">
    <img alt="æœ¬ç«™æ”¯æŒIPv6è®¿é—®"
         src="https://static.ipw.cn/icon/ipv6-certified-s1.svg">
  </a>

  <a href="https://ipw.cn/ssl/?site=https://jekyll.tungchiahui.cn" 
     title="æœ¬ç«™æ”¯æŒSSLå®‰å…¨è®¿é—®" target="_blank">
    <img alt="æœ¬ç«™æ”¯æŒSSLå®‰å…¨è®¿é—®"
         src="https://static.ipw.cn/icon/ssl-s1.svg">
  </a>
</div>

  <div class="footer-records">
    <!-- ICP å¤‡æ¡ˆå· -->
    
    <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener" class="footer-record icp">
      <img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/footer/favicon-miit.webp" alt="å·¥ä¿¡éƒ¨å›¾æ ‡">
      é²ICPå¤‡2025185601å·-2
    </a>
    

    <!-- å…¬å®‰å¤‡æ¡ˆå· -->
    
    <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=é²å…¬ç½‘å®‰å¤‡37030302001121å·" target="_blank" rel="noopener" class="footer-record beian">
      <img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/footer/favicon-mps.webp" alt="å…¬å®‰å¤‡æ¡ˆå›¾æ ‡">
      é²å…¬ç½‘å®‰å¤‡37030302001121å·
    </a>
    
  </div>

</footer>

    <!-- è¿™æ‰æ˜¯liquildçš„æ³¨é‡Šï¼Œä¸èƒ½ç”¨htmlçš„æ³¨é‡Š -->
    <!-- å› ä¸ºliquidä¼šæŠŠhtmlçš„æ³¨é‡Šä¹Ÿæ¸²æŸ“å‡ºæ¥ -->
    


    <!-- PJAX -->
    <script src="https://cdn.tungchiahui.cn/libs/pjax/0.2.8/pjax.min.js" defer></script>
    <script src="/assets/js/pjax-init.js" defer></script>
    <!-- æ–°åŠ çš„é”šç‚¹ä¿®å¤ -->
    <script src="/assets/js/pjax-fix-toc-anchor.js" defer></script> 

    
  </body>
</html>
